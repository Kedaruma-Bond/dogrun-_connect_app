<%= turbo_stream_from @dogrun_place, "top" %>
<% content_for(:title, @dogrun_place.name) %>
<div class='max-w-5xl mx-3 md:mx-auto pt-2 pb-2 sm:mx-32 text-center bg-purple-200 rounded-lg'
  data-controller="filming-message-modal sns-post-message-modal"
  >
  <% if logged_in? %>
    <% if !@publishing_post.blank? %>
      <div class="mx-auto mt-1 w-full sm:w-2/3 md:w-1/2 xl:w-1/3 py-2 rounded-xl border-2 border-neutral-400
        bg-[url('https://res.cloudinary.com/hryerpkcw/image/upload/f_auto,g_center,q_auto/v1671380081/w4ygbtfdkxu3gzrixk6u.jpg')]
      ">
        <div class="flex justify-center">
          <h3 class="text-white font-bold text-lg self-center"><%= t('local.static_pages.top.dogrun_board') %></h3>
          <button class="rounded-md bg-amber-500 w-7 h-7 relative ml-2 flex">
            <%= link_to('javascript:void(0);', onclick: "window.location.reload();", 
                class: "absolute top-1 left-1 font-medium tracking-wide text-slate-500 capitalize transition-colors duration-300 transform rounded-md hover:text-slate-700 focus:outline-none") do %>
              <svg class="w-5 h-5 text-white" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z" clip-rule="evenodd" />
              </svg>
            <% end %>
          </button>
        </div>
        <%= @publishing_post[0].post_viewing %>
      </div>
    <% end %>
    <% if @dogrun_place.name == "犬のしつけ広場" %> 
      <h1 class="my-1">
        <%= simple_format(t('togo_inu_shitsuke_hiroba.staticpages.top.under_commissioning'), class: "font-bold text-lg text-red-600") %>
      </h1>
    <% end %>
    <%= turbo_frame_tag dom_id(@dogrun_place, "top_view_changeover_closing"), class: "w-full sm:px-10 pt-1 sm:pb-0" do %>
      <% if @dogrun_place.closed_flag == true %>
        <div class="my-10">
          <%= simple_format(I18n.t("local.static_pages.top.dogrun_is_closing_now", dogrun_name: @dogrun_place.name), class: "text-gray-700 font-bold text-2xl") %>
          <% if !@dogrun_place.force_closing? %>
            <div class="mt-3 text-gray-700 font-medium">
                <% if !@dogrun_place.opening_time.blank? || !@dogrun_place.closing_time.blank? %>
                  <p class="text-sm mt-2">
                    <%= t('defaults.business_time') %>
                  </p>
                  <h2 class="mt-1">
                    <%= l @dogrun_place.opening_time, format: :short2 %>
                    〜
                    <%= l @dogrun_place.closing_time, format: :short2 %>
                  </h2>
                <% end %>
            </div>
          <% end %>
        </div>
      <% else %>
        <div class="flex flex-col mt-1 font-bold">
          <p class='text-center text-gray-700 text-2xl relative right-7'>
            <%= t('local.static_pages.top.site_in') %>
          </p>
          <%= turbo_frame_tag dom_id(@dogrun_place, :num_of_playing_dogs) do %>
            <%= render partial: "shared/num_of_playing_dogs", locals: { num_of_playing_dogs: @num_of_playing_dogs } %>
          <% end %>
          <%= turbo_frame_tag dom_id(@dogrun_place, :among_them_non_public_dogs) do %>
            <%= render partial: "shared/among_them_non_public_dogs", locals: { dogs_non_public: @dogs_non_public }  %>
          <% end %>
        </div>
        <%= render partial: 'shared/during_pre_entry_dogs_content', locals: { dog_profile_path: @dog_profile_path } %>
        <% if !current_user.guest? %>
          <%= turbo_frame_tag dom_id(@dogrun_place, :login_top_content) do %>
            <%= render partial: 'shared/login_top_content', locals: { entries_path: @entries_path, pre_entries_path: @pre_entries_path } %>
          <% end %>
        <% end %>
        <%= render partial: 'shared/during_entry_dogs_content', locals: { dog_profile_path: @dog_profile_path } %>
      <% end %>
    <% end %>

    <% if current_user.guest? %>
      <div class="inline-flex overflow-hidden rounded-lg shadow mt-2 sm:w-auto sm:mx-3 animate-heartbeat">
        <%= button_to send(@jump_to_signup_path), method: :post,
            class: "inline-flex items-center justify-center w-full px-5 py-3 text-base font-medium text-gray-200 bg-blue-500 hover:bg-blue-600 sm:w-auto" do %>
          <svg class="w-7 h-7 inline-block" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
            <path d="M8 9a3 3 0 100-6 3 3 0 000 6zM8 11a6 6 0 016 6H2a6 6 0 016-6zM16 7a1 1 0 10-2 0v1h-1a1 1 0 100 2h1v1a1 1 0 102 0v-1h1a1 1 0 100-2h-1V7z"></path>
          </svg>
          <span class="mx-2">
            <%= t('local.static_pages.top.jump_to_signup') %>
          </span>
        <% end %>
      </div>
    <% end %>
  <% else %>
    <div class="w-1/2 md:w-1/3 lg:1/4 h-auto mx-auto mt-3">
      <%= dogrun_logo(@dogrun_place) %>
    </div>
    <%= link_to @dogrun_terms_of_service_page, target: "_blank", rel: "noopener noreferrer" do %>
      <p class="mt-10 text-2xl text-center font-semibold text-blue-500 underline transform hover:scale-110 hover:text-blue-400 duration-500">
        <%= t('local.static_pages.top.before_using_dogrun') %>
      </p>
    <% end %>
    <div class="flex-col">
      <%= link_to send(@login_path) do %>
        <button class="mx-auto flex px-6 py-2 text-2xl mt-10 text-white bg-emerald-500 transform hover:scale-110 hover:bg-emerald-400 duration-500 focus:outline-none focus:shadow-outline rounded-full focus:ring focus:ring-blue-300 focus:ring-opacity-80">
          <svg class="w-7 h-7" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
            <path fill-rule="evenodd" d="M3 3a1 1 0 011 1v12a1 1 0 11-2 0V4a1 1 0 011-1zm7.707 3.293a1 1 0 010 1.414L9.414 9H17a1 1 0 110 2H9.414l1.293 1.293a1 1 0 01-1.414 1.414l-3-3a1 1 0 010-1.414l3-3a1 1 0 011.414 0z" clip-rule="evenodd"></path>
          </svg>
          &nbsp;
          <%= t('defaults.login') %>
        </button>
      <% end %>
      <%= link_to send(@signup_path) do %>
        <button class="mx-auto flex px-6 py-2 text-2xl mt-5 text-white bg-blue-500 transform hover:scale-110 hover:bg-blue-400 duration-500 focus:outline-none focus:shadow-outline rounded-full focus:ring focus:ring-blue-300 focus:ring-opacity-80">
          <svg class="w-7 h-7" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
            <path d="M8 9a3 3 0 100-6 3 3 0 000 6zM8 11a6 6 0 016 6H2a6 6 0 016-6zM16 7a1 1 0 10-2 0v1h-1a1 1 0 100 2h1v1a1 1 0 102 0v-1h1a1 1 0 100-2h-1V7z"></path>
          </svg>
          &nbsp;
          <%= t('defaults.signup') %>
        </button>
      <% end %>
      <%= button_to send(@guest_login_path), method: :post,
          class: "mx-auto px-4 py-2 text-lg mt-7 text-indigo-500 capitalize transition-colors duration-300 transform bg-stone-300 rounded-full hover:bg-stone-100 focus:outline-none focus:ring focus:ring-blue-300 focus:ring-opacity-80" do %>
          <svg fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="text-indigo-500 w-6 h-6 mb-1 inline-block" viewBox="0 0 24 24">
            <path d="M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"></path>
            <circle cx="9" cy="7" r="4"></circle>
            <path d="M23 21v-2a4 4 0 00-3-3.87m-4-12a4 4 0 010 7.75"></path>
          </svg>
          <span class="mx-1"><%= t('local.static_pages.top.guest_login') %></span>
        </class:>
      <% end %>
      <p class="text-center"><%= simple_format(t('local.static_pages.top.check_app_by_trial_guest_login'), class: "text-indigo-500 text-sm") %></p>
    </div>
  <% end %>
</div>
